
export
    CCequations


    ####RECORDS
    ## 6,3, [1,2]: (51 real) [31.725178640742822, 64.68954678105638, 155.02564131816794, -187.9439403652868, 92.55641944444504, 40.33389550795434, -114.27428336763117, 86.97144159546374, -163.21548106977392, -70.43383063322683, -15.742272232396054, -15.305194487236216, 45.56065838859504, -9.179535572269097, 164.1332301446409, 88.45761282062908, 14.020532516528409, 36.30085226537621, -238.43854737617042, 82.93832566978577, 30.876699423835202, 140.28593996840593, -17.387219911752325, -95.93813382805715, 177.06429471948258, -2.0047764384764815, 116.93914643343517, -45.17980522649678, 140.30291032293638, -57.009603495102404, -54.017231839895935, 49.089881355257766, 42.11557100754806, -35.06005314398606, -63.35575252278344, -382.507035076065, 111.7073797825336, -4.763090196815403, 158.18811545382087, 40.857164086937985, -116.27222804585911, 43.16105599645392, -18.354859894094243, 174.15396435104432, 54.3490366471823, -86.22841254750725, -79.16052345460993, 74.16779399462872, 88.08395535570608, -146.07481222912418, -9.978830421936475, -36.81928983722605, 33.53021176935435, 9.809424604224956, 15.76192490058894, -8.108601817001428, 158.06246878862817, -176.04425450929065, -127.35679715001308, -4.528083871325359, 29.299772325746638, -89.35648518273528, -52.746773288394444, -14.093562707617485, 134.5450012169103, -57.05876343009215, -115.62249756224985, -39.549316698031994, -113.61827758202412, -128.52558225684535, -104.08402144749255, -112.76058741778915, 96.52107462264854, 6.405690450447518, 82.21642711919532, -34.340714805540166, 34.8300656087259, -72.60652294371523, 66.48838453954892, -64.59337765772176, 4.2917811491882345, 35.46413692559356, -15.198359255099739, 36.26872629066529, -22.361742214701177, 17.64092777471268, -100.70349865659924, 64.08588942774293, 39.89239879156011, -90.89509164266775, 47.129904229555855, -23.831908998475445, -98.87919888219295, -109.91742232907671, -163.52564040419523, -23.4476993970085, -134.37485992743632, 19.08207200832929, 40.67766114433163, -217.99695129865447, -99.13206941879741, 187.30030449100872, -104.35258235664543, 99.09530630803748, 2.678409257869475, -130.45420408201161, 16.58620958328129, -104.90795303072298, 35.812695569322884, 122.45825944701741, 86.91563986468805, -174.674207729079, -127.47979076774595, 134.87330887559324, 68.6284960076902, 46.41967779722573, 48.48390027197903, -26.78864298754105, 51.55748427130053, -112.72841439051112, -58.31605471864902, -18.454939297142918, 52.72133857601066, -93.60749267938208, 56.470533683786655, 60.869952620471196, 145.25005053769615, -61.84163070067374, -80.41392624352267, 44.49518248167761, -108.27679602684913, 23.93883561122556, 205.81931803179975, -30.1754689601497, 48.173162771169864, -26.074304512449032, 87.36320767780104, 2.0526628836473164, 26.782366762845623, -200.24671646842398, -60.13703414961081, 35.649489912135245, 106.64759669514206, 68.79717226166586, 107.2522505520821, 49.56549458525481, 75.36250681999367, 172.47562235171063, -63.13761703917891, -12.253282082642178, -125.244874742448, -13.230554259524766, -131.23192906290691, 107.17289453689577, 168.86016359447444, 18.721054310095546, -98.20067282228787, 244.6452622784901, 54.617551344048515, 96.02403341073477, -128.51538654939853, -100.05014712430632, 57.00574516485847, -151.1267196837444, -23.942606364785092, 65.76629874100519, 124.08817438350869, -25.665611819703535, -28.070928357764625, -3.8850831967995334, -11.354092974683725, 139.70196679060882, 11.491260890938175, 60.07576647874277, 19.026966661398014, -8.996119858573394, -72.63754313409174, -43.11499470734909, 122.28110635793745, 72.52177074136247, 47.827984836075814, 88.45442539777778, 142.65375136165244, -95.1171153382125, -29.13119505416849, -14.597841107378525, 11.086110967572576, 13.712717003158149, -30.14748112630951, 94.72750352449923, -5.500166885643015, 114.07431081916832, -31.53037052043061, 86.62556591077866, -12.400031167036559, -41.274233818531016, 3.505105536273758, -140.27539030920784, -190.11801693188778, -17.50626515343831, 88.16167062749889, -54.61242431038252, -27.309592049513792, 67.36318155332177, -106.51264149346382, 121.99269202088757, 37.44226609617829, 89.6260995811044, -17.32456040019763, 26.81523313830237]
function base_lt(x, y, r)
    return length(x ∩ r) > length(y ∩ r)
end

function CCequations(n,d,sigma)
    basis = collect(combinations(1:n,d))

    sort!(basis, lt=(x,y) -> base_lt(x,y, Set(1:d)))

    nchoosed = binomial(n,d);
    T = Matrix(undef, nchoosed, nchoosed);

    for (i, row) in enumerate(basis)
        for (j, col) in enumerate(basis)
            rowset = Set(row);
            colset = Set(col);
            alpha = sort!(collect(setdiff(colset,rowset)));
            beta = sort!(collect(setdiff(rowset,colset)));

            l = length(alpha);
            if length(beta) == l && l in sigma && all(x -> x <= d, alpha) && all(x -> x > d, beta)
                s = [findfirst(y -> y == a, col) for a in alpha];
                r = [findfirst(y -> y == b, row) for b in beta];

                alpha_str = parse(Int64, string(alpha...));
                beta_str = parse(Int64, string(beta...));

                T[i,j] = (-1)^(sum(r) + sum(s))*Variable(:t, alpha_str, beta_str) ;
            else 
                T[i,j] = 0;
            end 
        end
    end
    @var h[1:nchoosed, 1:nchoosed], lambda;

    params = [h[i,j] for i in 1:nchoosed for j in i:nchoosed];

    proj = [1];

    for l in sigma
        firstindex = sum([binomial(d,i)*binomial(n - d,i) for i in 0:(l - 1)]) 
        lastindex = binomial(d,l)*binomial(n - d,l)
        append!(proj, firstindex + 1:firstindex + lastindex)
    end

    H = [h[min(i,j),max(i,j)] for i in 1:nchoosed, j in 1:nchoosed];

    expT = I + sum([(1//factorial(k)).*T^k for k in 1:d]);

    P = HomotopyContinuation.expand.((H - lambda*I)*expT[:,1]);

    equations = P[proj];

    F = System(equations, parameters=params)

    E = EnumerativeProblem(F)
end

